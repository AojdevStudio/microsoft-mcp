[tool:pytest]
# Pytest configuration for Microsoft MCP
# Story 1.7: Configure CI to skip legacy tests (85% test maintenance reduction)

testpaths = tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*

# Addopts: Add options that are always used
addopts = 
    # Skip legacy tests in CI to reduce maintenance burden
    -m "not legacy"
    # Show local variables in traceback for debugging
    --tb=short
    # Show test progress
    -v
    # Capture print statements
    -s

# Markers: Define custom test markers
markers =
    legacy: Legacy tests moved during consolidation (Stories 1.3-1.6) - excluded from CI
    migration: Migration validation tests (Story 1.7) - primary CI test suite
    integration: Integration tests requiring external services
    performance: Performance benchmark tests
    slow: Tests that take more than 5 seconds
    email_framework: Email framework specific tests
    utility_tools: Utility tools tests from Story 1.6

# Minimum coverage requirements (can be adjusted)
# Note: With legacy test exclusion, coverage should be maintained through migration tests
filterwarnings =
    ignore::DeprecationWarning
    ignore::UserWarning:*deprecated*
    # Allow deprecation warnings from our own tools to be shown during migration period

# Test discovery patterns
# Exclude legacy tests from automatic discovery
norecursedirs = 
    .git
    .tox
    dist
    build
    south_migrations
    tests/legacy/archived

# Timeout for individual tests (prevent hanging)
timeout = 300

# Parallel execution settings (if pytest-xdist is available)
# addopts = -n auto